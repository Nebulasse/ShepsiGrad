# Руководство по тестированию приложения ShepsiGrad

## Введение

Это руководство описывает подход к тестированию приложения ShepsiGrad, состоящего из двух основных частей:

1. Мобильное приложение для арендаторов (ShepsiGradNew)
2. Бэкенд-сервис (backend)

## Структура тестов

### Бэкенд-тесты

Тесты для бэкенда расположены в директории `backend/src/tests/` и разделены на:

- `unit/` - модульные тесты для отдельных компонентов
- `integration/` - интеграционные тесты для API

#### Запуск тестов бэкенда

```bash
# Запуск всех тестов
cd backend
npm run test

# Запуск только модульных тестов
npm run test:unit

# Запуск только интеграционных тестов
npm run test:integration

# Запуск тестов с покрытием кода
npm run test:coverage
```

### Мобильное приложение

Тесты для мобильного приложения расположены в директории `ShepsiGradNew/__tests__/` и разделены на:

- `components/` - тесты для компонентов React Native
- `mocks/` - моки для тестирования

#### Запуск тестов мобильного приложения

```bash
# Запуск всех тестов
cd ShepsiGradNew
npm run test
```

## Известные проблемы и решения

### Проблемы с AuthContext

Компоненты приложения используют AuthContext для аутентификации, что создает проблемы при тестировании. Для решения этой проблемы необходимо:

1. Создать мок для AuthContext (`__tests__/mocks/mockAuthContext.tsx`)
2. Обернуть тестируемые компоненты в MockAuthProvider
3. При необходимости модифицировать компоненты для упрощения тестирования

### Проблемы с TypeScript

При запуске тестов могут возникать ошибки типизации. Для их решения:

1. Используйте опцию `isolatedModules: true` в конфигурации Jest
2. Временно отключите строгую проверку типов в тестах

## Рекомендации по написанию тестов

### Модульные тесты

1. Тестируйте каждую функцию/метод отдельно
2. Используйте моки для внешних зависимостей
3. Проверяйте граничные случаи и обработку ошибок

### Интеграционные тесты

1. Тестируйте взаимодействие между компонентами
2. Проверяйте корректность API-запросов
3. Используйте моки для внешних сервисов (например, платежных систем)

### Тесты UI-компонентов

1. Проверяйте корректное отображение компонентов
2. Тестируйте обработку пользовательских событий
3. Проверяйте состояния загрузки, ошибок и успешного выполнения

## Дальнейшие улучшения

1. Настроить CI/CD для автоматического запуска тестов
2. Увеличить покрытие кода тестами
3. Добавить E2E-тесты для проверки полного пользовательского пути
4. Реализовать тесты производительности для критичных частей приложения
